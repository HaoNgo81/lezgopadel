<!doctype html>
<html lang="da">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>LezGo Padel â€” Training Bank</title>

<link rel="manifest" href="/lezgopade/manifest.json">
<meta name="theme-color" content="#0f1720">

<style>
/* ========== BASE ========== */
*{box-sizing:border-box}
html,body{margin:0;padding:0;font-family:Inter,system-ui,Arial,sans-serif;background:#071226;color:#e6eef6}
:root{
  --panel:#12202a;--muted:#9aa7b3;--accent:#22c55e;--danger:#ef4444;
  --border:rgba(255,255,255,.08)
}
.container{max-width:1100px;margin:auto;padding:10px}

/* ========== HEADER ========== */
header{display:grid;grid-template-columns:1fr auto 1fr;align-items:center}
#logo{height:48px}
#top-controls{justify-self:end;display:flex;gap:8px}
button,select,input,textarea{
  background:var(--panel);color:#e6eef6;border:1px solid var(--border);
  border-radius:8px;padding:8px;font-size:14px
}
button{cursor:pointer;font-weight:700}
button.primary{background:var(--accent);color:#05261a}
button.ghost{background:transparent;color:var(--muted)}
select option{background:var(--panel);color:#e6eef6}

/* ========== FORMS ========== */
.card{background:var(--panel);padding:12px;border-radius:12px;margin-bottom:12px}
label{font-size:12px;color:var(--muted)}
input,textarea,select{width:100%}
textarea{min-height:70px}

/* ========== LIST ========== */
.exercise{border:1px solid var(--border);border-radius:10px;padding:8px;margin-bottom:8px;display:flex;gap:10px}
.exercise .left{flex:1}
.exercise .title{font-weight:800}
.exercise .meta{font-size:11px;color:var(--muted)}
.actions{display:flex;flex-direction:column;gap:6px}
.tag{font-size:10px;padding:3px 6px;background:rgba(255,255,255,.05);border-radius:6px}

/* ========== FOOTER BAR ========== */
#bottom-bar{
  position:fixed;bottom:12px;left:12px;right:12px;
  display:flex;justify-content:center;gap:12px;
}
</style>
</head>

<body>
<div class="container">

<header>
  <div></div>
  <img id="logo" src="lezgo-logo.svg">
  <div id="top-controls">
    <button id="theme-toggle">ðŸŒ™</button>
    <select id="lang-select"><option value="da">DA</option><option value="en">EN</option></select>
  </div>
</header>

<div class="card">
<h3 id="form-title">TilfÃ¸j Ã¸velse</h3>
<label>Titel</label><input id="title">
<label>Kategori</label><select id="category"></select>
<label>Spillere</label><select id="players"></select>
<label>Varighed</label><input id="duration" type="number">
<label>Niveau</label><select id="level"></select>
<label>Intensitet</label><select id="intensity"></select>
<label>Link</label><input id="link">
<label>Beskrivelse</label><textarea id="description"></textarea>
<label>Tags</label><input id="tags">
<br>
<button id="save-btn" class="primary">Gem</button>
<button id="cancel-edit-btn" class="ghost" style="display:none">Annuller</button>
</div>

<div class="card">
<h3>Ã˜velser</h3>
<div id="list"></div>
</div>

</div>

<div id="bottom-bar">
  <button id="backup-btn" class="primary">Backup</button>
  <button id="restore-btn">Restore</button>
</div>

<script>
/* ================== DATA ================== */
const EX_KEY="lezgo_ex_v1",SES_KEY="lezgo_ses_v1";
let exercises=[],editingId=null;

/* ================== INIT ================== */
const $=id=>document.getElementById(id);
document.addEventListener("DOMContentLoaded",()=>{
  exercises=JSON.parse(localStorage.getItem(EX_KEY)||"[]");
  populateSelects();
  render();
});

/* ================== SELECTS ================== */
function populateSelects(){
  const sets={
    category:["Volley","Smash","Defense"],
    players:["1","2","3","4"],
    level:["Beginner","Intermediate","Advanced"],
    intensity:["Low","Medium","High"]
  };
  Object.entries(sets).forEach(([id,arr])=>{
    const sel=$(id); sel.innerHTML="";
    arr.forEach(v=>{const o=document.createElement("option");o.value=v;o.text=v;sel.appendChild(o)});
  });
}

/* ================== SAVE ================== */
$("save-btn").onclick=()=>{
  const ex={
    id:editingId||crypto.randomUUID(),
    title:$("title").value,
    category:$("category").value,
    players:$("players").value,
    duration:$("duration").value,
    level:$("level").value,
    intensity:$("intensity").value,
    link:$("link").value,
    description:$("description").value,
    tags:$("tags").value
  };
  if(editingId){
    const i=exercises.findIndex(x=>x.id===editingId);
    exercises[i]=ex;
  }else exercises.unshift(ex);

  editingId=null;
  localStorage.setItem(EX_KEY,JSON.stringify(exercises));
  render();
};

/* ================== RENDER ================== */
function render(){
  const list=$("list"); list.innerHTML="";
  exercises.forEach(ex=>{
    const d=document.createElement("div"); d.className="exercise";
    d.innerHTML=`
      <div class="left">
        <div class="title">${ex.title}</div>
        <div class="meta">${ex.category} â€¢ ${ex.players} â€¢ ${ex.duration}m</div>
        ${ex.tags?ex.tags.split(",").map(t=>`<span class="tag">${t}</span>`).join(""):""}
      </div>
      <div class="actions">
        <button onclick="editEx('${ex.id}')">Rediger</button>
      </div>`;
    list.appendChild(d);
  });
}
window.editEx=id=>{
  const ex=exercises.find(x=>x.id===id);
  editingId=id;
  Object.keys(ex).forEach(k=>$(k)&&($(k).value=ex[k]));
  $("cancel-edit-btn").style.display="inline-block";
};

/* ================== BACKUP ================== */
async function doBackup(){
  const data=JSON.stringify({exercises},null,2);
  if(window.showSaveFilePicker){
    const h=await showSaveFilePicker({suggestedName:"lezgo_backup.json",types:[{accept:{"application/json":[".json"]}}]});
    const w=await h.createWritable(); await w.write(data); await w.close();
  }else{
    const a=document.createElement("a");
    a.href=URL.createObjectURL(new Blob([data],{type:"application/json"}));
    a.download="lezgo_backup.json"; a.click();
  }
}

/* ================== RESTORE ================== */
async function doRestore(){
  let file;
  if(window.showOpenFilePicker){
    [h]=await showOpenFilePicker({types:[{accept:{"application/json":[".json"]}}]});
    file=await h.getFile();
  }else{
    file=await new Promise(r=>{
      const i=document.createElement("input");
      i.type="file";i.accept=".json";
      i.onchange=()=>r(i.files[0]);i.click();
    });
  }
  const data=JSON.parse(await file.text());
  exercises=data.exercises||[];
  localStorage.setItem(EX_KEY,JSON.stringify(exercises));
  render();
}

$("backup-btn").onclick=doBackup;
$("restore-btn").onclick=doRestore;
</script>

</body>
</html>
