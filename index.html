<!doctype html>
<html lang="da">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>LezGo Padel ‚Äî Training Bank</title>

<meta name="theme-color" content="#0f1720" id="meta-theme-color">

<style>
/* ================= RESET ================= */
*,*::before,*::after{box-sizing:border-box}
html,body{margin:0;padding:0;height:100%;overflow-x:hidden;font-family:Inter,system-ui,Arial,sans-serif}
body{background:linear-gradient(180deg,#0f1720,#071226);color:#e6eef6}

/* ================= THEME ================= */
body.light{
  background:linear-gradient(180deg,#caced5,#bfc3cb);
  color:#0b1220;
}

/* ================= LAYOUT ================= */
.container{max-width:1100px;margin:auto;padding:12px}
header{text-align:center;margin-bottom:14px}
#logo{height:54px;margin-bottom:8px}

.card{
  background:#0b1a25;
  border-radius:14px;
  padding:14px;
  margin-bottom:14px;
  box-shadow:0 10px 28px rgba(2,6,23,.6)
}
body.light .card{background:#d8dce3}

/* ================= FORM ================= */
label{font-size:13px;color:#9aa7b3}
input,select,textarea{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.1);
  background:transparent;
  color:inherit;
  margin-top:4px
}
textarea{min-height:80px}

/* ================= GRID ================= */
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media(max-width:720px){.grid-2{grid-template-columns:1fr}}

/* ================= BUTTONS ================= */
.btn{padding:10px 14px;border-radius:12px;border:none;font-weight:800;cursor:pointer}
.btn-primary{background:#22c55e;color:#05261a}
.btn-ghost{background:transparent;color:#9aa7b3}
.btn-danger{background:#ef4444;color:#fff}

/* ================= DROPDOWN DELETE ================= */
.select-wrap{display:flex;gap:6px;align-items:center}
.trash{cursor:pointer;color:#ef4444;font-size:18px}

/* ================= LIST ================= */
.exercise{
  border:1px solid rgba(255,255,255,.08);
  border-radius:10px;
  padding:10px;
  margin-bottom:8px
}
.exercise b{font-size:15px}
.meta{color:#9aa7b3;font-size:13px}

/* ================= TAG ================= */
.tag{background:rgba(255,255,255,.06);padding:4px 6px;border-radius:6px;margin-right:4px;font-size:12px}

/* ================= FOOTER BAR ================= */
#bottom-bar{
  position:fixed;
  bottom:10px;
  left:10px;
  right:10px;
  max-width:1080px;
  margin:auto;
  display:none;
  gap:10px;
  justify-content:center
}
</style>
</head>

<body>
<div class="container">

<header>
  <img id="logo" src="lezgo-logo.svg" alt="LezGo">
</header>

<!-- FORM -->
<div class="card">
<h3>Add / Edit Exercise</h3>

<label>Title</label>
<input id="title">

<div class="grid-2">
  <div>
    <label>Category</label>
    <div class="select-wrap">
      <select id="category"></select>
      <span class="trash" data-del="category">üóëÔ∏è</span>
    </div>
  </div>

  <div>
    <label>Coach</label>
    <div class="select-wrap">
      <select id="coach"></select>
      <span class="trash" data-del="coach">üóëÔ∏è</span>
    </div>
  </div>
</div>

<div class="grid-2">
  <div>
    <label>Level</label>
    <div class="select-wrap">
      <select id="level"></select>
      <span class="trash" data-del="level">üóëÔ∏è</span>
    </div>
  </div>

  <div>
    <label>Intensity</label>
    <div class="select-wrap">
      <select id="intensity"></select>
      <span class="trash" data-del="intensity">üóëÔ∏è</span>
    </div>
  </div>
</div>

<div>
  <label>Players</label>
  <div class="select-wrap">
    <select id="players"></select>
    <span class="trash" data-del="players">üóëÔ∏è</span>
  </div>
</div>

<label>Video link</label>
<input id="link">

<label>Description</label>
<textarea id="description"></textarea>

<label>Tags</label>
<input id="tags">

<div style="margin-top:10px">
  <button class="btn btn-primary" id="save-ex">Save Exercise</button>
</div>
</div>

<!-- FILTER -->
<div class="card">
<h3>Filter</h3>
<div class="grid-2">
  <select id="filter-category"></select>
  <select id="filter-coach"></select>
</div>
</div>

<!-- LIST -->
<div class="card">
<h3>Exercises</h3>
<div id="list"></div>
</div>

</div>

<!-- BOTTOM BAR -->
<div id="bottom-bar">
  <button class="btn btn-primary" id="backup">Backup</button>
  <button class="btn btn-ghost" id="restore">Restore</button>
  <input type="file" id="restore-file" hidden>
</div>

<script>
/* ================== STORAGE KEYS ================== */
const EX_KEY = "lezgo_exercises_v_final";
const CAT_KEY = "lezgo_categories_v_final";
const COACH_KEY = "lezgo_coaches_v_final";
const LVL_KEY = "lezgo_levels_v_final";
const INT_KEY = "lezgo_intensities_v_final";
const PLR_KEY = "lezgo_players_v_final";

/* ================== STATE ================== */
let exercises = JSON.parse(localStorage.getItem(EX_KEY)) || [];
let categories = JSON.parse(localStorage.getItem(CAT_KEY)) || ["Back wall","Volley","Serve"];
let coaches = JSON.parse(localStorage.getItem(COACH_KEY)) || ["LezGo Padel"];
let levels = JSON.parse(localStorage.getItem(LVL_KEY)) || ["Beginner","Intermediate","Advanced"];
let intensities = JSON.parse(localStorage.getItem(INT_KEY)) || ["Low","Medium","High"];
let players = JSON.parse(localStorage.getItem(PLR_KEY)) || ["1","2","3","4","Any"];

const $ = id => document.getElementById(id);

/* ================== ROLE ================== */
const isAdmin = () => localStorage.getItem("is_admin") === "1";
const isPaid  = () => localStorage.getItem("is_paid") === "1";

/* ================== SAVE ================== */
function persist(){
  localStorage.setItem(EX_KEY, JSON.stringify(exercises));
  localStorage.setItem(CAT_KEY, JSON.stringify(categories));
  localStorage.setItem(COACH_KEY, JSON.stringify(coaches));
  localStorage.setItem(LVL_KEY, JSON.stringify(levels));
  localStorage.setItem(INT_KEY, JSON.stringify(intensities));
  localStorage.setItem(PLR_KEY, JSON.stringify(players));
}

/* ================== POPULATE ================== */
function fillSelect(sel, arr){
  sel.innerHTML = "";
  arr.forEach(v=>{
    const o=document.createElement("option");
    o.value=v; o.textContent=v;
    sel.appendChild(o);
  });
  const add=document.createElement("option");
  add.value="__ADD__";
  add.textContent="‚ûï Add new‚Ä¶";
  sel.appendChild(add);
}

function populateAll(){
  fillSelect(category, categories);
  fillSelect(coach, coaches);
  fillSelect(level, levels);
  fillSelect(intensity, intensities);
  fillSelect(players, players);

  fillSelect(filter-category, categories);
  fillSelect(filter-coach, coaches);
}

/* ================== ADD NEW ================== */
["category","coach","level","intensity","players"].forEach(id=>{
  $(id).addEventListener("change", e=>{
    if(e.target.value==="__ADD__"){
      const v=prompt("New value:");
      if(v){
        window[id+"s"].push(v.trim());
        persist(); populateAll();
        e.target.value=v.trim();
      }
    }
  });
});

/* ================== DELETE (RULE B) ================== */
document.querySelectorAll(".trash").forEach(t=>{
  t.addEventListener("click", ()=>{
    if(!isAdmin()) return alert("Admin only");
    const key=t.dataset.del;
    const val=$(key).value;
    if(!val) return;
    if(!confirm(`Delete "${val}"?`)) return;

    window[key+"s"] = window[key+"s"].filter(x=>x!==val);
    exercises.forEach(e=>{
      if(e[key]===val) e[key]="";
    });
    persist(); populateAll(); render();
  });
});

/* ================== SAVE EXERCISE ================== */
$("save-ex").onclick=()=>{
  if(!$("title").value.trim()) return alert("Title required");
  const ex={
    id:Date.now(),
    title:title.value.trim(),
    category:category.value,
    coach:coach.value,
    level:level.value,
    intensity:intensity.value,
    players:players.value,
    link:link.value.trim(),
    description:description.value.trim(),
    tags:tags.value.trim()
  };
  exercises.unshift(ex);
  persist(); render();
};

/* ================== RENDER ================== */
function render(){
  list.innerHTML="";
  const fc=$("filter-category").value;
  const fco=$("filter-coach").value;

  exercises
    .filter(e=>(!fc||e.category===fc)&&(!fco||e.coach===fco))
    .forEach(e=>{
      const d=document.createElement("div");
      d.className="exercise";
      d.innerHTML=`
        <b>${e.title}</b>
        <div class="meta">
          ${e.category||"‚Äî"} ‚Ä¢ ${e.level||"‚Äî"} ‚Ä¢ ${e.coach||"‚Äî"}
        </div>
        ${e.link?`<a href="${e.link}" target="_blank">${e.link}</a>`:""}
        <div>
          ${(e.tags||"").split(",").filter(Boolean).map(t=>`<span class="tag">${t.trim()}</span>`).join("")}
        </div>
      `;
      list.appendChild(d);
    });
}

/* ================== FILTER ================== */
$("filter-category").onchange=render;
$("filter-coach").onchange=render;

/* ================== BACKUP / RESTORE ================== */
const bottomBar = $("bottom-bar");
if(isAdmin()||isPaid()) bottomBar.style.display="flex";

$("backup").onclick=()=>{
  const data={
    exercises,categories,coaches,levels,intensities,players,
    exported:new Date().toISOString()
  };
  const blob=new Blob([JSON.stringify(data,null,2)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="lezgo-backup.json";
  a.click();
};

$("restore").onclick=()=> $("restore-file").click();
$("restore-file").onchange=e=>{
  const f=e.target.files[0];
  if(!f) return;
  const r=new FileReader();
  r.onload=()=>{
    const d=JSON.parse(r.result);
    exercises=d.exercises||[];
    categories=d.categories||[];
    coaches=d.coaches||[];
    levels=d.levels||[];
    intensities=d.intensities||[];
    players=d.players||[];
    persist(); populateAll(); render();
  };
  r.readAsText(f);
};

/* ================== INIT ================== */
populateAll();
render();
</script>
</body>
</html>
